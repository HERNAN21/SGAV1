import{_ as K,u as z,a as G,r as n,o as _,h as b,w as a,b as l,f as c,t as x,c as O,F as j,i as E,j as Q,s as I,k as W,l as X,m as Y,n as Z,p as ee,q as te,v as ae,x as le,y as oe,z as ne,A as se,B as re,C as ue,D as ie,G as N,H as P,e as q,I as T,J as ce,K as de,g as _e,L as F,R as fe,M as A,N as pe,O as d,P as U,Q as me,S as ve}from"./index-DlKmiQXQ.js";const he={class:"role-brand"},ge={class:"role-header-title"},be={class:"role-header-actions"},ye={__name:"RoleDashboardLayout",props:{title:{type:String,required:!0},role:{type:String,required:!0},pageTitle:{type:String,required:!0},activeMenu:{type:String,required:!0},items:{type:Array,default:()=>[]}},setup(f){const s=z(),y=G(),v={DataBoard:N,User:ie,OfficeBuilding:ue,Notification:re,Calendar:se,Reading:ne,Tickets:oe,Notebook:le,School:ae,Document:te,Money:ee,Collection:Z,Bell:Y,Suitcase:X,Files:W,SwitchButton:I},h=i=>v[i]||N,B=i=>{s.push(i)},o=async()=>{try{y.token&&await ce.logout()}catch{}finally{y.logout(),s.replace({name:"login"})}};return(i,p)=>{const w=n("el-icon"),r=n("el-menu-item"),R=n("el-menu"),D=n("el-aside"),k=n("el-tag"),C=n("el-button"),M=n("el-header"),L=n("el-main"),V=n("el-container");return _(),b(V,{class:"role-layout"},{default:a(()=>[l(D,{class:"role-aside",width:"280px"},{default:a(()=>[c("div",he,[p[0]||(p[0]=c("div",{class:"role-brand-logo"},"SG",-1)),c("div",null,[c("h3",null,x(f.title),1),c("small",null,x(f.role),1)])]),l(R,{class:"role-menu","default-active":f.activeMenu,onSelect:B},{default:a(()=>[(_(!0),O(j,null,E(f.items,e=>(_(),b(r,{key:e.index,index:e.index},{default:a(()=>[l(w,null,{default:a(()=>[(_(),b(Q(h(e.icon))))]),_:2},1024),c("span",null,x(e.label),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"])]),_:1}),l(V,null,{default:a(()=>[l(M,{class:"role-header"},{default:a(()=>[c("div",ge,x(f.pageTitle),1),c("div",be,[P(i.$slots,"actions",{},void 0,!0),l(k,{type:"primary",effect:"light"},{default:a(()=>[q(x(f.role),1)]),_:1}),l(C,{type:"danger",plain:"",onClick:o},{default:a(()=>[l(w,null,{default:a(()=>[l(T(I))]),_:1}),p[1]||(p[1]=q(" Cerrar sesión ",-1))]),_:1})])]),_:3}),l(L,{class:"role-main"},{default:a(()=>[P(i.$slots,"default",{},void 0,!0)]),_:3})]),_:3})]),_:3})}}},xe=K(ye,[["__scopeId","data-v-d41105e8"]]),$="dashboard_role_filter",g="__ALL__",S="/dashboard",Se={__name:"AppDashboard",setup(f){const s=de(),y=z(),v=G(),h=d(()=>{var t,u;const e=((t=v.user)==null?void 0:t.roles)||[];return e.length>0?e:(u=v.user)!=null&&u.rol_principal?[v.user.rol_principal]:[]}),B=d(()=>{var e;return o.value===g?A(((e=v.user)==null?void 0:e.rol_principal)||"Usuario"):A(o.value)}),o=_e(localStorage.getItem($)||g);F(h,e=>{if(e.length===0){o.value=g;return}o.value!==g&&!e.some(t=>U(t,o.value))&&(o.value=g)},{immediate:!0});const i=(e,t)=>ve(e.roles||[],t),p=d(()=>{const e=h.value;return me.filter(t=>i(t,e))}),w=d(()=>o.value===g?p.value:p.value.filter(e=>!e.roles||e.roles.length===0?!0:e.roles.some(t=>U(t,o.value)))),r=d(()=>w.value.map(e=>({index:`/dashboard/${e.path}`.replace(/\/$/,""),label:e.label,icon:e.icon}))),R=d(()=>{var t;const e=r.value.find(u=>u.index===s.path);return e?e.index:s.path===S?S:((t=r.value[0])==null?void 0:t.index)||S}),D=d(()=>{var e;return((e=r.value.find(t=>t.index===R.value))==null?void 0:e.label)||"Dashboard"}),k=d({get:()=>s.path==="/dashboard/perfil",set:()=>{}}),C=async()=>{var t;const e=((t=r.value[0])==null?void 0:t.index)||S;s.path!==e&&await y.replace(e)},M=async()=>{const e=s.path===S?"/dashboard":s.path;r.value.some(u=>u.index===e)||await C()};F(r,async()=>{await M()},{immediate:!0});const L=async e=>{localStorage.setItem($,e),await M()},V=async e=>{if(e){await y.push("/dashboard/perfil");return}await C()};return(e,t)=>{const u=n("el-option"),H=n("el-select"),J=n("el-switch");return _(),b(xe,{title:"Panel Unificado",role:B.value,"page-title":D.value,"active-menu":R.value,items:r.value},{actions:a(()=>[h.value.length>1?(_(),b(H,{key:0,modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=m=>o.value=m),size:"small",class:"role-select",onChange:L},{default:a(()=>[l(u,{label:"Todos",value:"__ALL__"}),(_(!0),O(j,null,E(h.value,m=>(_(),b(u,{key:m,label:T(A)(m),value:m},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):pe("",!0),l(J,{modelValue:k.value,"onUpdate:modelValue":t[1]||(t[1]=m=>k.value=m),"inline-prompt":"","active-text":"Perfil","inactive-text":"Módulos",onChange:V},null,8,["modelValue"])]),default:a(()=>[l(T(fe))]),_:1},8,["role","page-title","active-menu","items"])}}},Re=K(Se,[["__scopeId","data-v-5c77b6ef"]]);export{Re as default};
