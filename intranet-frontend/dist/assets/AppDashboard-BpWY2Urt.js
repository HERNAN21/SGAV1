import{_ as P,u as U,o as _,h as b,w as a,a as l,f as c,t as x,c as $,i as K,F as z,j as T,e as A,k as G,s as I,r as n,l as H,b as O,m as J,n as Q,p as W,q as X,v as Y,x as Z,y as ee,z as te,A as ae,B as le,C as oe,D as ne,G as se,H as re,I as ue,J as N,g as ie,K as q,L as d,M as ce,R as de,N as _e,O as fe}from"./index-KQn30iXK.js";const pe={class:"role-brand"},me={class:"role-header-title"},ve={class:"role-header-actions"},he={__name:"RoleDashboardLayout",props:{title:{type:String,required:!0},role:{type:String,required:!0},pageTitle:{type:String,required:!0},activeMenu:{type:String,required:!0},items:{type:Array,default:()=>[]}},setup(f){const r=O(),y=U(),v={DataBoard:N,User:ue,OfficeBuilding:re,Notification:se,Calendar:ne,Reading:oe,Tickets:le,Notebook:ae,School:te,Document:ee,Money:Z,Collection:Y,Bell:X,Suitcase:W,Files:Q,SwitchButton:I},h=i=>v[i]||N,B=i=>{r.push(i)},o=async()=>{try{y.token&&await H.logout()}catch{}finally{y.logout(),r.replace({name:"login"})}};return(i,p)=>{const w=n("el-icon"),u=n("el-menu-item"),k=n("el-menu"),D=n("el-aside"),C=n("el-tag"),R=n("el-button"),M=n("el-header"),L=n("el-main"),V=n("el-container");return _(),b(V,{class:"role-layout"},{default:a(()=>[l(D,{class:"role-aside",width:"280px"},{default:a(()=>[c("div",pe,[p[0]||(p[0]=c("div",{class:"role-brand-logo"},"SG",-1)),c("div",null,[c("h3",null,x(f.title),1),c("small",null,x(f.role),1)])]),l(k,{class:"role-menu","default-active":f.activeMenu,onSelect:B},{default:a(()=>[(_(!0),$(z,null,K(f.items,e=>(_(),b(u,{key:e.index,index:e.index},{default:a(()=>[l(w,null,{default:a(()=>[(_(),b(J(h(e.icon))))]),_:2},1024),c("span",null,x(e.label),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"])]),_:1}),l(V,null,{default:a(()=>[l(M,{class:"role-header"},{default:a(()=>[c("div",me,x(f.pageTitle),1),c("div",ve,[T(i.$slots,"actions",{},void 0,!0),l(C,{type:"primary",effect:"light"},{default:a(()=>[A(x(f.role),1)]),_:1}),l(R,{type:"danger",plain:"",onClick:o},{default:a(()=>[l(w,null,{default:a(()=>[l(G(I))]),_:1}),p[1]||(p[1]=A(" Cerrar sesión ",-1))]),_:1})])]),_:3}),l(L,{class:"role-main"},{default:a(()=>[T(i.$slots,"default",{},void 0,!0)]),_:3})]),_:3})]),_:3})}}},ge=P(he,[["__scopeId","data-v-d41105e8"]]),F="dashboard_role_filter",g="__ALL__",S="/dashboard",be={__name:"AppDashboard",setup(f){const r=ce(),y=O(),v=U(),h=d(()=>{var t,s;const e=((t=v.user)==null?void 0:t.roles)||[];return e.length>0?e:(s=v.user)!=null&&s.rol_principal?[v.user.rol_principal]:[]}),B=d(()=>{var e;return o.value===g?((e=v.user)==null?void 0:e.rol_principal)||"Usuario":o.value}),o=ie(localStorage.getItem(F)||g);q(h,e=>{if(e.length===0){o.value=g;return}o.value!==g&&!e.includes(o.value)&&(o.value=g)},{immediate:!0});const i=(e,t)=>!e.roles||e.roles.length===0?!0:e.roles.some(s=>t.includes(s)),p=d(()=>{const e=h.value;return fe.filter(t=>i(t,e))}),w=d(()=>o.value===g?p.value:p.value.filter(e=>!e.roles||e.roles.length===0?!0:e.roles.includes(o.value))),u=d(()=>w.value.map(e=>({index:`/dashboard/${e.path}`.replace(/\/$/,""),label:e.label,icon:e.icon}))),k=d(()=>{var t;const e=u.value.find(s=>s.index===r.path);return e?e.index:r.path===S?S:((t=u.value[0])==null?void 0:t.index)||S}),D=d(()=>{var e;return((e=u.value.find(t=>t.index===k.value))==null?void 0:e.label)||"Dashboard"}),C=d({get:()=>r.path==="/dashboard/perfil",set:()=>{}}),R=async()=>{var t;const e=((t=u.value[0])==null?void 0:t.index)||S;r.path!==e&&await y.replace(e)},M=async()=>{const e=r.path===S?"/dashboard":r.path;u.value.some(s=>s.index===e)||await R()};q(u,async()=>{await M()},{immediate:!0});const L=async e=>{localStorage.setItem(F,e),await M()},V=async e=>{if(e){await y.push("/dashboard/perfil");return}await R()};return(e,t)=>{const s=n("el-option"),j=n("el-select"),E=n("el-switch");return _(),b(ge,{title:"Panel Unificado",role:B.value,"page-title":D.value,"active-menu":k.value,items:u.value},{actions:a(()=>[h.value.length>1?(_(),b(j,{key:0,modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=m=>o.value=m),size:"small",class:"role-select",onChange:L},{default:a(()=>[l(s,{label:"Todos",value:"__ALL__"}),(_(!0),$(z,null,K(h.value,m=>(_(),b(s,{key:m,label:m,value:m},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):_e("",!0),l(E,{modelValue:C.value,"onUpdate:modelValue":t[1]||(t[1]=m=>C.value=m),"inline-prompt":"","active-text":"Perfil","inactive-text":"Módulos",onChange:V},null,8,["modelValue"])]),default:a(()=>[l(G(de))]),_:1},8,["role","page-title","active-menu","items"])}}},xe=P(be,[["__scopeId","data-v-55f17c07"]]);export{xe as default};
